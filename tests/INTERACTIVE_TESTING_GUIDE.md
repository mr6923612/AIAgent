# 🖥️ 交互式模糊匹配测试器

## 🚀 快速启动

```bash
cd tests
python -m unit.start_fuzzy_matching_test
# 或者
python run_tests_by_category.py
# 选择 5 - 交互式测试器
```

## 🎯 两种测试方式

### 1. 图形界面测试器 (推荐)
- 直观的参数调节界面
- 实时图片预览
- 拖拽式操作

### 2. 命令行测试器
- 纯文本界面
- 支持脚本化测试
- 适合批量测试

## ⚙️ 可调节参数

- **文字匹配阈值** (0.0-1.0): 控制文字查询的最低相关性分数
- **图片相似度阈值** (0.0-1.0): 控制图片匹配的最低相似度  
- **询问确认阈值** (0.0-1.0): 当最佳匹配低于此阈值时询问用户确认
- **最大结果数** (1-20): 返回的最大匹配结果数量
- **搜索策略**: 产品查询模式或通用客服模式

## 🎛️ 参数预设模式

- **严格模式**: 高精度，少结果 (阈值: 0.3, 0.8, 0.8)
- **宽松模式**: 低精度，多结果 (阈值: 0.05, 0.5, 0.95)  
- **默认模式**: 平衡设置 (阈值: 0.1, 0.7, 0.9)

## 🧪 测试功能

### 文字查询测试
- 输入任意文字查询
- 查看匹配结果和相关性分数
- 支持中文和英文查询

### 图片查询测试  
- 上传图片文件 (支持PNG, JPG, JPEG, GIF, BMP)
- 查看图片相似度匹配结果
- 显示匹配的产品信息

### 组合查询测试
- 同时输入文字和图片
- 测试多模态匹配效果
- 查看综合匹配结果

## 📊 相关性分数解读

- **1.0**: 完全匹配
- **0.8-0.9**: 高度相关
- **0.6-0.7**: 中度相关
- **0.3-0.5**: 低度相关
- **0.0-0.2**: 几乎不相关

## 🔧 参数调节位置

实际的RAG检索器参数需要修改源码中的以下位置：

### 主要参数位置 (`crewaiBackend/utils/rag_retriever.py`)
- **第189行**: `if relevance > 0.1` - 文字匹配最低阈值
- **第150行**: `if best_result["relevance"] < 0.9` - 询问确认阈值  
- **第274行**: `if similarity > 0.7` - 图片相似度阈值
- **第337-390行**: `_calculate_relevance` 方法中的各种匹配分数权重

## 💡 使用建议

### 参数调节策略
1. **提高匹配精度**: 将阈值从0.1提高到0.3
2. **降低匹配精度**: 将阈值从0.1降低到0.05
3. **使用交互式测试器**: 实时调整参数查看效果

### 测试流程
1. 启动测试器
2. 设置参数（或使用预设模式）
3. 输入测试内容（文字或图片）
4. 查看匹配结果
5. 根据结果调整参数
6. 保存重要测试结果

## 🐛 故障排除

### 常见问题
1. **图形界面无法启动**: 使用命令行测试器
2. **图片加载失败**: 检查图片文件路径和格式
3. **测试结果为空**: 降低匹配阈值或检查输入内容

### 调试技巧
1. **查看详细日志**: 测试器会显示处理过程
2. **测试不同输入**: 尝试不同的查询和图片
3. **参数对比测试**: 使用不同参数测试相同输入